## Рекомендательная система
### Цель
Предсказание рейтинга товаров на основе истории отзывов о них c целью увеличения чека продаж

### Описание кейса
Крупная компания занимающется онлайн-ритейлом (розничными продажами в интернете).
Необходимо увеличить средний чек продаж. 
Чем точнее рекомендовать нужный товар пользователю (в нашем случае это товар с более высоким средним чеком), тем выше вероятность покупки этого товара. Простая логика.
Имеется история оценок пользователя вместе с его отзывом на товар. Текст рецензии можно использовать в качестве дополнительной информации. Все оценки пользователей нормированы для бинарной классификации: если человек поставил оценку продукту 4 и больше, то считается, что продукт ему понравился, если меньше 4, то продукт не понравился.

### Выводы
1. Проведен разведочный анализ данных. Показано, что существуют пользователи, выставляющие только положительные или только отрицательные оценки товарам, а также товары, у которых нет отрицательных, или, наоборот, положительных отзывов.
2. Обучены модели, основанные на матричной факторизации, а также content-based модели. Показано, что добавление метаинформации о пользователях и товарах снижает score на kaggle.
3. Получены эмбеддинги пользователей и товаров в виде сумм векторов скрытых признаков и смещений, которые можно трактовать как поправки на оптимизм/пессимизм пользователя при оценке товаров и на изначальное мнение о товаре (возможно, из-за его брэнда и т.д.)
4. Показаны пути решения проблемы холодного старта. Установлено, что решение этой проблемы возможно в случае, если имеется метаинформация о пользователях и товарах. Более подробно о проблеме холодного старта: LightFM, как и другие рекоментадельные алгоритмы, не позволяет выдавать рекомендации абсолютно новым пользователям в том случае, если о них отсутствует дополнительная информация. Проблема может быть решена путем описания пользователей признаками, которые алгорим использует во время обучения. Например, модель обучается на пользователях с ID от 0 до 10, а рекомендацию нужно выдать пользователю с ID 11. Если кроме ID о новом пользователе ничего неизвестно, алгоритм будет неспособен к рекомендации, т.к. ничего неизвестно о предпочтениях нового пользователя. Однако предположим, что имеются некоторые признаки, с помощью которых можно описывать пользователей: возможно, в процессе регистрации каждый пользователь выбирает определенное количество интересующих его объектов (фильмы ужасов или романтические комедии, например). Если эти признаки присутствуют в процессе обучения модели, алгоритм может "выучить" какие предпочтения в среднем связаны с этими характеристиками, и будет способен осуществлять рекомендации по отношению к любым новым пользователям, которые могут быть описаны признаками такого же характера. В представленном примере выдать рекомендации пользователю с ID 11 можно в том случае, если в наличии есть предпочтения, которые он выбрал во время регистрации. В реализации LightFM все эти признаки будут закодированы в матрицы, возможно, путем one-hot encoding. Для выдачи рекомендаций пользователю 11 нужно сконструировать новую матрицу признаков для этого пользователя: пока эта матрица признаков содержит только признаки, присутствующие в процесс обучения модели, будет возможной выдача рекомендаций. Заметим, что обычно полезно иметь признак, который соответствует только одному пользователю: 'Is user 0', 'Is user 1' и т.д. В случае новых пользователей ткой признак бесполезен, так как в процессе обучения модели отсутствует информация, которую она может использовать.

